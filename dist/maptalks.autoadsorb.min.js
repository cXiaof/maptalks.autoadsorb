/*!
 * maptalks.autoadsorb v0.4.0
 * LICENSE : MIT
 * (c) 2016-2022 maptalks.org
 */
/*!
 * requires maptalks@>=0.46.0 
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("maptalks")):"function"==typeof define&&define.amd?define(["exports","maptalks"],e):e(t.maptalks=t.maptalks||{},t.maptalks)}(this,function(t,i){"use strict";function s(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(o(t[0])&&o(t[1]))return t={type:"Point",coordinates:t},e=e,n={type:"Feature"},0!==(r=void 0===(r=r)?{}:r).id&&!r.id||(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n;var n;throw new Error("coordinates must contain numbers")}function o(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function w(t,e,r){if(null!==t)for(var n,o,i,a=0,u=t.type,s="FeatureCollection"===u,c="Feature"===u,f=s?t.features.length:1,l=0;l<f;l++)for(var p,h,_=(h=!!(p=s?t.features[l].geometry:c?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1,y=0;y<_;y++){var d=0,b=0,v=h?p.geometries[y]:p;if(null!==v){var g=v.coordinates,m=v.type,j=!r||"Polygon"!==m&&"MultiPolygon"!==m?0:1;switch(m){case null:break;case"Point":if(!1===e(g,a,l,d,b))return!1;a++,d++;break;case"LineString":case"MultiPoint":for(n=0;n<g.length;n++){if(!1===e(g[n],a,l,d,b))return!1;a++,"MultiPoint"===m&&d++}"LineString"===m&&d++;break;case"Polygon":case"MultiLineString":for(n=0;n<g.length;n++){for(o=0;o<g[n].length-j;o++){if(!1===e(g[n][o],a,l,d,b))return!1;a++}"MultiLineString"===m&&d++,"Polygon"===m&&b++}"Polygon"===m&&d++;break;case"MultiPolygon":for(n=0;n<g.length;n++){for(o=b=0;o<g[n].length;o++){for(i=0;i<g[n][o].length-j;i++){if(!1===e(g[n][o][i],a,l,d,b))return!1;a++}b++}d++}break;case"GeometryCollection":for(n=0;n<v.geometries.length;n++)if(!1===w(v.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function a(e){var t,r,n,o=[];if("FeatureCollection"===e.type){var i=e,a=function(e){w(e,function(t){o.push(s(t,e.properties))})};if("Feature"===i.type)a(i,0);else if("FeatureCollection"===i.type)for(var u=0;u<i.features.length&&!1!==a(i.features[u],u);u++);}else w(e,function(t){o.push(s(t,e.properties))});return t=o,n={type:"FeatureCollection"},(r=void 0===r?{}:r).id&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.features=t,n}var ne="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=(e(function(t,e){var n="__lodash_hash_undefined__",$=1,J=2,S=9007199254740991,G="[object Arguments]",I="[object Array]",A="[object AsyncFunction]",K="[object Boolean]",X="[object Date]",Y="[object Error]",P="[object Function]",E="[object GeneratorFunction]",D="[object Map]",Q="[object Number]",k="[object Null]",R="[object Object]",L="[object Promise]",M="[object Proxy]",Z="[object RegExp]",U="[object Set]",tt="[object String]",et="[object Symbol]",F="[object Undefined]",r="[object WeakMap]",rt="[object ArrayBuffer]",N="[object DataView]",x=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,o={},i=(o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o[G]=o[I]=o[rt]=o[K]=o[N]=o[X]=o[Y]=o[P]=o[D]=o[Q]=o[R]=o[Z]=o[U]=o[tt]=o[r]=!1,"object"==It(ne)&&ne&&ne.Object===Object&&ne),a="object"==("undefined"==typeof self?"undefined":It(self))&&self&&self.Object===Object&&self,a=i||a||Function("return this")(),e=e&&!e.nodeType&&e,u=e&&t&&!t.nodeType&&t,u=u&&u.exports===e,s=u&&i.process,e=function(){try{return s&&s.binding&&s.binding("util")}catch(t){}}(),i=e&&e.isTypedArray;function nt(t){var r=-1,n=Array(t.size);return t.forEach(function(t,e){n[++r]=[e,t]}),n}function ot(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var C,z,e=Array.prototype,c=Function.prototype,f=Object.prototype,l=a["__core-js_shared__"],it=c.toString,B=f.hasOwnProperty,at=(c=/[^.]+$/.exec(l&&l.keys&&l.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",ut=f.toString,st=RegExp("^"+it.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),l=u?a.Buffer:void 0,c=a.Symbol,ct=a.Uint8Array,ft=f.propertyIsEnumerable,lt=e.splice,p=c?c.toStringTag:void 0,pt=Object.getOwnPropertySymbols,u=l?l.isBuffer:void 0,ht=(C=Object.keys,z=Object,function(t){return C(z(t))}),e=w(a,"DataView"),h=w(a,"Map"),l=w(a,"Promise"),_t=w(a,"Set"),a=w(a,"WeakMap"),_=w(Object,"create"),yt=O(e),dt=O(h),bt=O(l),vt=O(_t),gt=O(a),c=c?c.prototype:void 0,mt=c?c.valueOf:void 0;function y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function d(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function b(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function v(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new b;++e<r;)this.add(t[e])}function V(t){t=this.__data__=new d(t);this.size=t.size}function jt(t,e){var r,n,o,i=q(t),a=!i&&Mt(t),u=!i&&!a&&Ft(t),s=!i&&!a&&!u&&$t(t),c=i||a||u||s,f=c?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],l=f.length;for(r in t)!e&&!B.call(t,r)||c&&("length"==r||u&&("offset"==r||"parent"==r)||s&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||(n=r,(o=null==(o=l)?S:o)&&("number"==typeof n||T.test(n))&&-1<n&&n%1==0&&n<o))||f.push(r);return f}function g(t,e){for(var r=t.length;r--;)if(Lt(t[r][0],e))return r;return-1}function m(t){{if(null==t)return void 0===t?F:k;if(p&&p in Object(t)){var e=t,r=B.call(e,p),n=e[p];try{var o=!(e[p]=void 0)}catch(t){}var i=ut.call(e);return o&&(r?e[p]=n:delete e[p]),i}return ut.call(t)}}function wt(t){return H(t)&&m(t)==G}function Ot(t,e,r,n,o){{if(t===e)return!0;if(null==t||null==e||!H(t)&&!H(e))return t!=t&&e!=e;var i=Ot,a=q(t),u=q(e),s=a?I:W(t),u=u?I:W(e),c=(s=s==G?R:s)==R,f=(u=u==G?R:u)==R,u;if((u=s==u)&&Ft(t)){if(!Ft(e))return!1;c=!(a=!0)}if(u&&!c){o=o||new V;if(a||$t(t))return Pt(t,e,r,n,i,o);else{var l=t;var p=e;var h=s;var _=r;var y=n;var d=i;var b=o;switch(h){case N:if(l.byteLength!=p.byteLength||l.byteOffset!=p.byteOffset)return!1;l=l.buffer,p=p.buffer;case rt:return l.byteLength==p.byteLength&&d(new ct(l),new ct(p))?!0:!1;case K:case X:case Q:return Lt(+l,+p);case Y:return l.name==p.name&&l.message==p.message;case Z:case tt:return l==p+"";case D:var v=nt;case U:var g=_&$;if(v=v||ot,l.size!=p.size&&!g)return!1;g=b.get(l);if(g)return g==p;_|=J,b.set(l,p);g=Pt(v(l),v(p),_,y,d,b);return b.delete(l),g;case et:if(mt)return mt.call(l)==mt.call(p)}return!1;return}}if(!(r&$)){var a=c&&B.call(t,"__wrapped__"),s=f&&B.call(e,"__wrapped__");if(a||s)return c=a?t.value():t,f=s?e.value():e,o=o||new V,i(c,f,r,n,o)}if(u){o=o||new V;var m=t,j=e,w=r,O=n,S=i,A=o,P=w&$,E=Et(m),k=E.length,a=Et(j).length;if(k!=a&&!P)return!1;for(var L=k;L--;){var M=E[L];if(!(P?M in j:B.call(j,M)))return!1}if((a=A.get(m))&&A.get(j))return a==j;for(var F=!0,x=(A.set(m,j),A.set(j,m),P);++L<k;){M=E[L];var T,C=m[M],z=j[M];if(!(void 0===(T=O?P?O(z,C,M,j,m,A):O(C,z,M,m,j,A):T)?C===z||S(C,z,w,O,A):T)){F=!1;break}x=x||"constructor"==M}return F&&!x&&(a=m.constructor,s=j.constructor,a!=s&&"constructor"in m&&"constructor"in j&&!("function"==typeof a&&a instanceof a&&"function"==typeof s&&s instanceof s)&&(F=!1)),A.delete(m),A.delete(j),F}return!1}}function St(t){var e;if(Ct(t)&&(e=t,!(at&&at in e)))return(xt(t)?st:x).test(O(t))}function At(t){if(r="function"==typeof(r=(e=t)&&e.constructor)&&r.prototype||f,e!==r)return ht(t);var e,r,n,o=[];for(n in Object(t))B.call(t,n)&&"constructor"!=n&&o.push(n);return o}function Pt(t,e,r,n,o,i){var a=r&$,u=t.length,s=e.length;if(u!=s&&!(a&&u<s))return!1;s=i.get(t);if(s&&i.get(e))return s==e;var c=-1,f=!0,l=r&J?new v:void 0;for(i.set(t,e),i.set(e,t);++c<u;){var p,h=t[c],_=e[c];if(void 0!==(p=n?a?n(_,h,c,e,t,i):n(h,_,c,t,e,i):p)){if(p)continue;f=!1;break}if(l){if(!function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return 1}(e,function(t,e){return!l.has(e)&&(h===t||o(h,t,r,n,i))&&l.push(e)})){f=!1;break}}else if(h!==_&&!o(h,_,r,n,i)){f=!1;break}}return i.delete(t),i.delete(e),f}function Et(t){var e=Gt,r=kt;if(e=e(t),q(t))return e;for(var n=e,o=r(t),i=-1,a=o.length,u=n.length;++i<a;)n[u+i]=o[i];return n}function j(t,e){var r,n,t=t.__data__;return("string"==(n=void 0===(r=e)?"undefined":It(r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?t["string"==typeof e?"string":"hash"]:t.map}function w(t,e){e=e;t=null==(t=t)?void 0:t[e];return St(t)?t:void 0}y.prototype.clear=function(){this.__data__=_?_(null):{},this.size=0},y.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},y.prototype.get=function(t){var e,r=this.__data__;return _?(e=r[t])===n?void 0:e:B.call(r,t)?r[t]:void 0},y.prototype.has=function(t){var e=this.__data__;return _?void 0!==e[t]:B.call(e,t)},y.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=_&&void 0===e?n:e,this},d.prototype.clear=function(){this.__data__=[],this.size=0},d.prototype.delete=function(t){var e=this.__data__;return!((t=g(e,t))<0)&&(t==e.length-1?e.pop():lt.call(e,t,1),--this.size,!0)},d.prototype.get=function(t){var e=this.__data__;return(t=g(e,t))<0?void 0:e[t][1]},d.prototype.has=function(t){return-1<g(this.__data__,t)},d.prototype.set=function(t,e){var r=this.__data__,n=g(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},b.prototype.clear=function(){this.size=0,this.__data__={hash:new y,map:new(h||d),string:new y}},b.prototype.delete=function(t){return t=j(this,t).delete(t),this.size-=t?1:0,t},b.prototype.get=function(t){return j(this,t).get(t)},b.prototype.has=function(t){return j(this,t).has(t)},b.prototype.set=function(t,e){var r=j(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},v.prototype.add=v.prototype.push=function(t){return this.__data__.set(t,n),this},v.prototype.has=function(t){return this.__data__.has(t)},V.prototype.clear=function(){this.__data__=new d,this.size=0},V.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},V.prototype.get=function(t){return this.__data__.get(t)},V.prototype.has=function(t){return this.__data__.has(t)},V.prototype.set=function(t,e){var r=this.__data__;if(r instanceof d){var n=r.__data__;if(!h||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new b(n)}return r.set(t,e),this.size=r.size,this};var kt=pt?function(e){if(null==e)return[];e=Object(e);for(var t=pt(e),r=function(t){return ft.call(e,t)},n=-1,o=null==t?0:t.length,i=0,a=[];++n<o;){var u=t[n];r(u,n,t)&&(a[i++]=u)}return a}:function(){return[]},W=m;function O(t){if(null!=t){try{return it.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Lt(t,e){return t===e||t!=t&&e!=e}(e&&W(new e(new ArrayBuffer(1)))!=N||h&&W(new h)!=D||l&&W(l.resolve())!=L||_t&&W(new _t)!=U||a&&W(new a)!=r)&&(W=function(t){var e=m(t),t=e==R?t.constructor:void 0,t=t?O(t):"";if(t)switch(t){case yt:return N;case dt:return D;case bt:return L;case vt:return U;case gt:return r}return e});var Mt=wt(function(){return arguments}())?wt:function(t){return H(t)&&B.call(t,"callee")&&!ft.call(t,"callee")},q=Array.isArray;var Ft=u||function(){return!1};function xt(t){if(Ct(t))return t=m(t),t==P||t==E||t==A||t==M}function Tt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=S}function Ct(t){var e=void 0===t?"undefined":It(t);return null!=t&&("object"==e||"function"==e)}function H(t){return null!=t&&"object"==(void 0===t?"undefined":It(t))}var zt,$t=i?(zt=i,function(t){return zt(t)}):function(t){return H(t)&&Tt(t.length)&&!!o[m(t)]};function Gt(t){return(null!=(e=t)&&Tt(e.length)&&!xt(e)?jt:At)(t);var e}t.exports=function(t,e){return Ot(t,e)}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}),n="__lodash_hash_undefined__",T=9007199254740991,C="[object Arguments]",z="[object Function]",$="[object GeneratorFunction]",G=/^\[object .+?Constructor\]$/,r="object"==u(ne)&&ne&&ne.Object===Object&&ne,c="object"==("undefined"==typeof self?"undefined":u(self))&&self&&self.Object===Object&&self,r=r||c||Function("return this")();function I(t,e){return!!(t?t.length:0)&&-1<function(t,e,r){if(e!=e)return function(t,e,r,n){var o=t.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,R,r);var n=r-1,o=t.length;for(;++n<o;)if(t[n]===e)return n;return-1}(t,e,0)}function D(t,e,r){for(var n=-1,o=t?t.length:0;++n<o;)if(r(e,t[n]))return!0;return!1}function R(t){return t!=t}function U(t,e){return t.has(e)}var c=Array.prototype,f=Function.prototype,l=Object.prototype,p=r["__core-js_shared__"],h=(p=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",_=f.toString,y=l.hasOwnProperty,d=l.toString,N=RegExp("^"+_.call(y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),p=r.Symbol,B=l.propertyIsEnumerable,V=c.splice,b=p?p.isConcatSpreadable:void 0,f=Math.max,W=P(r,"Map"),v=P(Object,"create");function g(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function m(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function j(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function O(t){var e=-1,r=t?t.length:0;for(this.__data__=new j;++e<r;)this.add(t[e])}function S(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function q(t,e,r,n){var o,i=-1,a=I,u=!0,s=t.length,c=[],f=e.length;if(!s)return c;r&&(e=function(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(e,(o=r,function(t){return o(t)}))),n?(a=D,u=!1):200<=e.length&&(a=U,u=!1,e=new O(e));t:for(;++i<s;){var l=t[i],p=r?r(l):l,l=n||0!==l?l:0;if(u&&p==p){for(var h=f;h--;)if(e[h]===p)continue t;c.push(l)}else a(e,p,n)||c.push(l)}return c}function H(t){var e;if(L(t)&&(e=t,!(h&&h in e)))return(k(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?N:G).test(function(t){if(null!=t){try{return _.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function A(t,e){var r,n,t=t.__data__;return("string"==(n=void 0===(r=e)?"undefined":u(r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?t["string"==typeof e?"string":"hash"]:t.map}function P(t,e){e=e;t=null==(t=t)?void 0:t[e];return H(t)?t:void 0}function J(t){return K(t)||E(e=t)&&y.call(e,"callee")&&(!B.call(e,"callee")||d.call(e)==C)||!!(b&&t&&t[b]);var e}g.prototype.clear=function(){this.__data__=v?v(null):{}},g.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},g.prototype.get=function(t){var e,r=this.__data__;return v?(e=r[t])===n?void 0:e:y.call(r,t)?r[t]:void 0},g.prototype.has=function(t){var e=this.__data__;return v?void 0!==e[t]:y.call(e,t)},g.prototype.set=function(t,e){return this.__data__[t]=v&&void 0===e?n:e,this},m.prototype.clear=function(){this.__data__=[]},m.prototype.delete=function(t){var e=this.__data__;return!((t=S(e,t))<0)&&(t==e.length-1?e.pop():V.call(e,t,1),!0)},m.prototype.get=function(t){var e=this.__data__;return(t=S(e,t))<0?void 0:e[t][1]},m.prototype.has=function(t){return-1<S(this.__data__,t)},m.prototype.set=function(t,e){var r=this.__data__,n=S(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},j.prototype.clear=function(){this.__data__={hash:new g,map:new(W||m),string:new g}},j.prototype.delete=function(t){return A(this,t).delete(t)},j.prototype.get=function(t){return A(this,t).get(t)},j.prototype.has=function(t){return A(this,t).has(t)},j.prototype.set=function(t,e){return A(this,t).set(t,e),this},O.prototype.add=O.prototype.push=function(t){return this.__data__.set(t,n),this},O.prototype.has=function(t){return this.__data__.has(t)};l=function(t,e){var r,n=(r=(n=e)?n.length:0)?n[r-1]:void 0;return E(n)&&(n=void 0),E(t)?q(t,function t(e,r,n,o,i){var a=-1,u=e.length;for(n=n||J,i=i||[];++a<u;){var s=e[a];if(0<r&&n(s))if(1<r)t(s,r-1,n,o,i);else{h=p=l=f=c=void 0;for(var c=i,f=s,l=-1,p=f.length,h=c.length;++l<p;)c[h+l]=f[l]}else o||(i[i.length]=s)}return i}(e,1,E,!0),void 0,n):[]},M=f(void 0===M?l.length-1:M,0);var K=Array.isArray;function X(t){return null!=t&&("number"==typeof(e=t.length)&&-1<e&&e%1==0&&e<=T)&&!k(t);var e}function E(t){return!!(e=t)&&"object"==(void 0===e?"undefined":u(e))&&X(t);var e}function k(t){t=L(t)?d.call(t):"";return t==z||t==$}function L(t){var e=void 0===t?"undefined":u(t);return t&&("object"==e||"function"==e)}var oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e(function(t,e){var O="__lodash_hash_undefined__",$=1,G=2,f=1/0,S=9007199254740991,A=17976931348623157e292,P=NaN,I="[object Arguments]",K="[object Array]",X="[object Boolean]",Y="[object Date]",Q="[object Error]",E="[object Function]",k="[object GeneratorFunction]",D="[object Map]",Z="[object Number]",R="[object Object]",L="[object Promise]",tt="[object RegExp]",U="[object Set]",et="[object String]",rt="[object Symbol]",M="[object WeakMap]",nt="[object ArrayBuffer]",N="[object DataView]",F=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x=/^\w*$/,T=/^\./,C=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z=/^\s+|\s+$/g,ot=/\\(\\)?/g,it=/^[-+]0x[0-9a-f]+$/i,at=/^0b[01]+$/i,ut=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,ct=/^(?:0|[1-9]\d*)$/,r={},ft=(r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r[I]=r[K]=r[nt]=r[X]=r[N]=r[Y]=r[Q]=r[E]=r[D]=r[Z]=r[R]=r[tt]=r[U]=r[et]=r[M]=!1,parseInt),n="object"==oe(ne)&&ne&&ne.Object===Object&&ne,o="object"==("undefined"==typeof self?"undefined":oe(self))&&self&&self.Object===Object&&self,o=n||o||Function("return this")(),e=e&&!e.nodeType&&e,i=e&&t&&!t.nodeType&&t,lt=i&&i.exports===e&&n.process,i=function(){try{return lt&&lt.binding("util")}catch(t){}}(),e=i&&i.isTypedArray;function pt(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function ht(t){var r=-1,n=Array(t.size);return t.forEach(function(t,e){n[++r]=[e,t]}),n}function _t(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var yt,dt,n=Array.prototype,i=Function.prototype,a=Object.prototype,u=o["__core-js_shared__"],bt=(u=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",vt=i.toString,B=a.hasOwnProperty,s=a.toString,gt=RegExp("^"+vt.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),u=o.Symbol,mt=o.Uint8Array,jt=a.propertyIsEnumerable,wt=n.splice,Ot=(yt=Object.keys,dt=Object,function(t){return yt(dt(t))}),St=Math.max,i=v(o,"DataView"),c=v(o,"Map"),n=v(o,"Promise"),At=v(o,"Set"),o=v(o,"WeakMap"),l=v(Object,"create"),Pt=j(i),Et=j(c),kt=j(n),Lt=j(At),Mt=j(o),u=u?u.prototype:void 0,Ft=u?u.valueOf:void 0,xt=u?u.toString:void 0;function p(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function h(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function _(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function y(t){var e=-1,r=t?t.length:0;for(this.__data__=new _;++e<r;)this.add(t[e])}function V(t){this.__data__=new h(t)}function Tt(t,e){var r,n=q(t)||Jt(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],o=n.length,i=!!o;for(r in t)!e&&!B.call(t,r)||i&&("length"==r||Nt(r,o))||n.push(r);return n}function d(t,e){for(var r=t.length;r--;)if(Ht(t[r][0],e))return r;return-1}function Ct(t,e){for(var r=0,n=(e=g(e,t)?[e]:Rt(e)).length;null!=t&&r<n;)t=t[m(e[r++])];return r&&r==n?t:void 0}function zt(t,e){return null!=t&&e in Object(t)}function $t(t,e,r,n,o){{if(t===e)return!0;if(null==t||null==e||!H(t)&&!J(e))return t!=t&&e!=e;var i=$t,a=q(t),u=q(e),s=K,c=K,u=(a||(s=(s=W(t))==I?R:s),u||(c=(c=W(e))==I?R:c),s==R&&!pt(t)),f=c==R&&!pt(e),c;if((c=s==c)&&!u){o=o||new V;if(a||Zt(t))return Ut(t,e,i,r,n,o);else{var l=t;var p=e;var h=s;var _=i;var y=r;var d=n;var b=o;switch(h){case N:if(l.byteLength!=p.byteLength||l.byteOffset!=p.byteOffset)return!1;l=l.buffer,p=p.buffer;case nt:return l.byteLength==p.byteLength&&_(new mt(l),new mt(p))?!0:!1;case X:case Y:case Z:return Ht(+l,+p);case Q:return l.name==p.name&&l.message==p.message;case tt:case et:return l==p+"";case D:var v=ht;case U:var g=d&G;if(v=v||_t,l.size!=p.size&&!g)return!1;g=b.get(l);if(g)return g==p;d|=$,b.set(l,p);g=Ut(v(l),v(p),_,y,d,b);return b.delete(l),g;case rt:if(Ft)return Ft.call(l)==Ft.call(p)}return!1;return}}if(!(n&G)){var a=u&&B.call(t,"__wrapped__"),s=f&&B.call(e,"__wrapped__");if(a||s)return u=a?t.value():t,f=s?e.value():e,o=o||new V,i(u,f,r,n,o)}if(c){o=o||new V;var m=t,j=e,w=i,O=r,S=n,A=o,P=S&G,E=ee(m),k=E.length,a=ee(j).length;if(k!=a&&!P)return!1;for(var L=k;L--;){var M=E[L];if(!(P?M in j:B.call(j,M)))return!1}if((a=A.get(m))&&A.get(j))return a==j;for(var F=!0,x=(A.set(m,j),A.set(j,m),P);++L<k;){M=E[L];var T,C=m[M],z=j[M];if(!(void 0===(T=O?P?O(z,C,M,j,m,A):O(C,z,M,m,j,A):T)?C===z||w(C,z,O,S,A):T)){F=!1;break}x=x||"constructor"==M}return F&&!x&&(a=m.constructor,s=j.constructor,a!=s&&"constructor"in m&&"constructor"in j&&!("function"==typeof a&&a instanceof a&&"function"==typeof s&&s instanceof s)&&(F=!1)),A.delete(m),A.delete(j),F}return!1}}function Gt(t){var e;if(H(t)&&(e=t,!(bt&&bt in e)))return(Xt(t)||pt(t)?gt:ut).test(j(t))}function It(t){if("function"==typeof t)return t;if(null==t)return re;if("object"==(void 0===t?"undefined":oe(t)))if(q(t)){var n=t[0],o=t[1];return g(n)&&Bt(o)?Vt(m(n),o):function(t){var e,r=function(t,e,r){t=null==t?void 0:Ct(t,e);return void 0===t?r:t}(t,n);return void 0===r&&r===o?(e=n,null!=(t=t)&&function(t,e,r){e=g(e,t)?[e]:Rt(e);var n,o=-1,i=e.length;for(;++o<i;){var a=m(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&Yt(i)&&Nt(a,i)&&(q(t)||Jt(t))}(t,e,zt)):$t(o,r,void 0,$|G)}}else{var e=t,r=function(t){var e=ee(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,Bt(o)]}return e}(e);return 1==r.length&&r[0][2]?Vt(r[0][0],r[0][1]):function(t){return t===e||function(t,e,r,n){var o=r.length,i=o,a=!n;if(null==t)return!i;for(t=Object(t);o--;){var u=r[o];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<i;){var s=(u=r[o])[0],c=t[s],f=u[1];if(a&&u[2]){if(void 0===c&&!(s in t))return!1}else{var l,p=new V;if(!(void 0===(l=n?n(c,f,s,t,e,p):l)?$t(f,c,n,$|G,p):l))return!1}}return!0}(t,e,r)}}var i,a;return g(t=t)?(i=m(t),function(t){return null==t?void 0:t[i]}):(a=t,function(t){return Ct(t,a)})}function Dt(t){if(r="function"==typeof(r=(e=t)&&e.constructor)&&r.prototype||a,e!==r)return Ot(t);var e,r,n,o=[];for(n in Object(t))B.call(t,n)&&"constructor"!=n&&o.push(n);return o}function Rt(t){return q(t)?t:Wt(t)}function Ut(t,e,r,n,o,i){var a=o&G,u=t.length,s=e.length;if(u!=s&&!(a&&u<s))return!1;s=i.get(t);if(s&&i.get(e))return s==e;var c=-1,f=!0,l=o&$?new y:void 0;for(i.set(t,e),i.set(e,t);++c<u;){var p,h=t[c],_=e[c];if(void 0!==(p=n?a?n(_,h,c,e,t,i):n(h,_,c,t,e,i):p)){if(p)continue;f=!1;break}if(l){if(!function(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return 1}(e,function(t,e){return!l.has(e)&&(h===t||r(h,t,n,o,i))&&l.add(e)})){f=!1;break}}else if(h!==_&&!r(h,_,n,o,i)){f=!1;break}}return i.delete(t),i.delete(e),f}function b(t,e){var r,n,t=t.__data__;return("string"==(n=void 0===(r=e)?"undefined":oe(r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?t["string"==typeof e?"string":"hash"]:t.map}function v(t,e){e=e;t=null==(t=t)?void 0:t[e];return Gt(t)?t:void 0}p.prototype.clear=function(){this.__data__=l?l(null):{}},p.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},p.prototype.get=function(t){var e,r=this.__data__;return l?(e=r[t])===O?void 0:e:B.call(r,t)?r[t]:void 0},p.prototype.has=function(t){var e=this.__data__;return l?void 0!==e[t]:B.call(e,t)},p.prototype.set=function(t,e){return this.__data__[t]=l&&void 0===e?O:e,this},h.prototype.clear=function(){this.__data__=[]},h.prototype.delete=function(t){var e=this.__data__;return!((t=d(e,t))<0)&&(t==e.length-1?e.pop():wt.call(e,t,1),!0)},h.prototype.get=function(t){var e=this.__data__;return(t=d(e,t))<0?void 0:e[t][1]},h.prototype.has=function(t){return-1<d(this.__data__,t)},h.prototype.set=function(t,e){var r=this.__data__,n=d(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},_.prototype.clear=function(){this.__data__={hash:new p,map:new(c||h),string:new p}},_.prototype.delete=function(t){return b(this,t).delete(t)},_.prototype.get=function(t){return b(this,t).get(t)},_.prototype.has=function(t){return b(this,t).has(t)},_.prototype.set=function(t,e){return b(this,t).set(t,e),this},y.prototype.add=y.prototype.push=function(t){return this.__data__.set(t,O),this},y.prototype.has=function(t){return this.__data__.has(t)},V.prototype.clear=function(){this.__data__=new h},V.prototype.delete=function(t){return this.__data__.delete(t)},V.prototype.get=function(t){return this.__data__.get(t)},V.prototype.has=function(t){return this.__data__.has(t)},V.prototype.set=function(t,e){var r=this.__data__;if(r instanceof h){var n=r.__data__;if(!c||n.length<199)return n.push([t,e]),this;r=this.__data__=new _(n)}return r.set(t,e),this};var W=function(t){return s.call(t)};function Nt(t,e){return!!(e=null==e?S:e)&&("number"==typeof t||ct.test(t))&&-1<t&&t%1==0&&t<e}function g(t,e){var r;if(!q(t))return r=void 0===t?"undefined":oe(t),"number"==r||"symbol"==r||"boolean"==r||null==t||w(t)||(x.test(t)||!F.test(t)||null!=e&&t in Object(e))}function Bt(t){return t==t&&!H(t)}function Vt(e,r){return function(t){return null!=t&&(t[e]===r&&(void 0!==r||e in Object(t)))}}(i&&W(new i(new ArrayBuffer(1)))!=N||c&&W(new c)!=D||n&&W(n.resolve())!=L||At&&W(new At)!=U||o&&W(new o)!=M)&&(W=function(t){var e=s.call(t),t=e==R?t.constructor:void 0,t=t?j(t):void 0;if(t)switch(t){case Pt:return N;case Et:return D;case kt:return L;case Lt:return U;case Mt:return M}return e});var Wt=qt(function(t){t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(w(t))return xt?xt.call(t):"";var e=t+"";return"0"==e&&1/t==-f?"-0":e}(e);var e,o=[];return T.test(t)&&o.push(""),t.replace(C,function(t,e,r,n){o.push(r?n.replace(ot,"$1"):e||t)}),o});function m(t){if("string"==typeof t||w(t))return t;var e=t+"";return"0"==e&&1/t==-f?"-0":e}function j(t){if(null!=t){try{return vt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function qt(n,o){if("function"!=typeof n||o&&"function"!=typeof o)throw new TypeError("Expected a function");function i(){var t=arguments,e=o?o.apply(this,t):t[0],r=i.cache;return r.has(e)?r.get(e):(t=n.apply(this,t),i.cache=r.set(e,t),t)}return i.cache=new(qt.Cache||_),i}function Ht(t,e){return t===e||t!=t&&e!=e}function Jt(t){return J(e=t)&&Kt(e)&&B.call(t,"callee")&&(!jt.call(t,"callee")||s.call(t)==I);var e}qt.Cache=_;var q=Array.isArray;function Kt(t){return null!=t&&Yt(t.length)&&!Xt(t)}function Xt(t){t=H(t)?s.call(t):"";return t==E||t==k}function Yt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=S}function H(t){var e=void 0===t?"undefined":oe(t);return t&&("object"==e||"function"==e)}function J(t){return!!t&&"object"==(void 0===t?"undefined":oe(t))}function w(t){return"symbol"==(void 0===t?"undefined":oe(t))||J(t)&&s.call(t)==rt}var Qt,Zt=e?(Qt=e,function(t){return Qt(t)}):function(t){return J(t)&&Yt(t.length)&&!!r[s.call(t)]};function te(t){if("number"==typeof t)return t;if(w(t))return P;if("string"!=typeof(t=H(t)?H(e="function"==typeof t.valueOf?t.valueOf():t)?e+"":e:t))return 0===t?t:+t;t=t.replace(z,"");var e=at.test(t);return e||st.test(t)?ft(t.slice(2),e?2:8):it.test(t)?P:+t}function ee(t){return(Kt(t)?Tt:Dt)(t)}function re(t){return t}t.exports=function(t,e,r){var n=t?t.length:0;if(!n)return-1;for(var o=null==r?0:(r=function(t){return t?(t=te(t))!==f&&t!==-f?t==t?t:0:(t<0?-1:1)*A:0===t?t:0}(r=r),o=r%1,r==r?o?r-o:r:0),i=(o<0&&(o=St(n+o,0)),t),a=It(e),r=o,u=void 0,s=i.length,c=r+(u?1:-1);u?c--:++c<s;)if(a(i[c],c,i))return c;return-1}});c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p="object"==c(ne)&&ne&&ne.Object===Object&&ne,r="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,f=p||r||Function("return this")();var l=Object.prototype,M=(l.hasOwnProperty,l.toString,f.Symbol);l.propertyIsEnumerable,M&&M.isConcatSpreadable;Array.isArray;function Y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)if(Object.setPrototypeOf)Object.setPrototypeOf(t,e);else for(var r=t,n=e,o=Object.getOwnPropertyNames(n),i=0;i<o.length;i++){var a=o[i],u=Object.getOwnPropertyDescriptor(n,a);u&&u.configurable&&void 0===r[a]&&Object.defineProperty(r,a,u)}}var F,Q=i.INTERNAL_LAYER_PREFIX+"cxiaof_autoadsorb",c=(Y(x,F=i.Class),x.prototype.setMode=function(t){return this.options.mode=t,this._updateGeosSet(),this},x.prototype.getMode=function(){return this.options.mode},x.prototype.setDistance=function(t){return this.options.distance=t,this._updateGeosSet(),this},x.prototype.getDistance=function(){return this.options.distance},x.prototype.isEnable=function(){return this._isEnable},x.prototype.bindDrawTool=function(t){return t instanceof i.DrawTool&&(this._map||this._addTo(t.getMap()),(this._drawTool=t).on("enable",this._enable,this),t.on("disable remove",this._disable,this),t.isEnabled()&&this._enable()),this},x.prototype.bindGeometry=function(t){return t instanceof i.Geometry&&(this._map||this._addTo(drawTool.getMap()),this._disableMapTool(),this._geometry=t,this._geometryCoords=t.getCoordinates(),t.on("editstart",this._enable,this),t.on("editend remove",this._disable,this),t.isEditing()&&this._enable()),this},x.prototype.remove=function(){this._disable(),this._cursorLayer&&this._cursorLayer.remove(),delete this._cursorLayer,delete this._assistLayers,delete this._needDeal,delete this._mousePoint,delete this._cursor,delete this._adsorbPoint,delete this._drawTool,delete this._map},x.prototype._addTo=function(t){this._map=t,this._newCursorLayer(),this._saveAdsorbLayers()},x.prototype._newCursorLayer=function(){this._cursorLayer=new i.VectorLayer(Q,{style:{symbol:this.options.cursorSymbol}}),this._cursorLayer.addTo(this._map).bringToFront()},x.prototype._saveAdsorbLayers=function(){var e=this;this._assistLayers=[],this.options.layers.forEach(function(t){(t="string"==typeof t?e._map.getLayer(t):t)instanceof i.VectorLayer&&e._assistLayers.push(t)})},x.prototype._enable=function(){console.log("enable"),this._isEnable=!0,this._cursorLayer&&this._cursorLayer.show(),map.on("mousedown",this._mapMousedown,this),map.on("mouseup",this._mapMouseup,this),map.on("mousemove",this._mapMousemove,this),this._updateGeosSet()},x.prototype._mapMousedown=function(){this._needFindGeometry=!!this._geometry},x.prototype._mapMouseup=function(){this._needFindGeometry=!this._geometry},x.prototype._mapMousemove=function(t){var e=t.coordinate,t=t.domEvent;this._needDeal=!0,this._mousePoint=e,this._cursor?this._cursor.setCoordinates(e):(this._cursor=new i.Marker(e),this._cursor.addTo(this._cursorLayer)),this._updateAdsorbPoint(e),this.options.needCtrl!==t.ctrlKey&&delete this._adsorbPoint},x.prototype._updateAdsorbPoint=function(t){this._needFindGeometry&&this._findGeometry(t)},x.prototype._findGeometry=function(t){},x.prototype._updateGeosSet=function(){var t=this._getAllAssistGeos();["auto","vertux"].includes(this.options.mode)&&(this._geosSetPoint=this._parseToPoints(t)),["auto","border"].includes(this.options.mode)&&(this._geosSetLine=this._parseToLines(t)),console.log(this._geosSetPoint)},x.prototype._getAllAssistGeos=function(){return this._assistLayers.reduce(function(t,e){return t.concat(e.getGeometries())},[])},x.prototype._parseToPoints=function(t){var n=this,o=[];return t.forEach(function(t){var e,r;o=(t instanceof i.GeometryCollection||(t instanceof i.Circle||t instanceof i.Ellipse)&&(r=(e=(t=t.copy()).options).numberOfShellPoints,e.numberOfShellPoints=Math.max(r,360),t.setOptions(e),o.push(n._getCenterFeature(t))),o.concat(a(t.toGeoJSON()).features))}),o},x.prototype._getCenterFeature=function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t.getCenter().toArray()},properties:{}}},x.prototype._parseToLines=function(t){return[]},x.prototype._disable=function(){console.log("disable"),this._isEnable=!1,this._cursorLayer&&this._cursorLayer.hide(),map.off("mousedown",this._mapMousedown,this),map.off("mousemove",this._mapMousemove,this),map.off("mouseup",this._mapMouseup,this),this._resetGeosSet(),delete this._geometry,delete this._geometryCoords},x.prototype._resetGeosSet=function(){},x.prototype._disableMapTool=function(){this._map._map_tool&&this._map._map_tool.disable()},x);function x(t){if(!(this instanceof x))throw new TypeError("Cannot call a class as a function");t=function(t,e){if(t)return!e||"object"!=typeof e&&"function"!=typeof e?t:e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,F.call(this,t));return t._isEnable=!1,t}c.mergeOptions({mode:"auto",layers:[],distance:10,needCtrl:!1,cursorSymbol:{markerType:"ellipse",markerFill:"#de3333",markerWidth:4,markerHeight:4,markerLineWidth:0}}),t.Autoadsorb=c,Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof console&&console.log("maptalks.autoadsorb v0.4.0, requires maptalks@>=0.46.0.")});